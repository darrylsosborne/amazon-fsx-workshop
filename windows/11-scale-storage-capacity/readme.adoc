= Scale storage capacity
:toc:
:icons:
:linkattrs:
:imagesdir: ../resources/images

== Summary

This section will demonstrate how to scale the storage capacity of the file system.


== Duration

NOTE: It will take approximately 15 minutes to complete this section.


== Step-by-step Guide

=== Scale storage capacity

IMPORTANT: Read through all steps below and watch the quick video before continuing.

image::scale-storage-capacity.gif[align="left", width=600]

. Return to the link:https://console.aws.amazon.com/fsx/[Amazon FSx] console. *_Click_* the link to the *MAZ* file system.
. In the *Summary* section, *_click_* the *[Update]* button next to *Storage capacity*.
. Increase the storage capacity of the file system by 10%. Accept the default _Input type_ *Percentage* and the default _Desired % increase_ *10%*. *_Click_* *[Update]*.
. Return to the browser-based SSH connection of the *FSx/W Workshop Linux Instance*.
+
TIP: If the SSH connection has timed out, e.g. the session is unresponsive, close the browser-based SSH connection window and create a new one. Return to the link:https://console.aws.amazon.com/ec2/[Amazon EC2] console. *_Click_* the radio button next to the instance with the name *FSx/W Workshop Linux Instance*. *_Click_* the *Connect* button. *_Click_* the radio button next to  *EC2 Instance Connect (browser-based SSH connection)*.Leave the default user name as *ec2-user* and *_click_* *Connect*.
+
. *_Run_* the following command in the browser-based SSH connection window to describe the file system.
+
[source,bash]
----
aws fsx describe-file-systems

----
+
* The end of the output should look similar to this:
+
[source,bash]
----
            "AdministrativeActions": [
                {
                    "Status": "UPDATED_OPTIMIZING",
                    "TargetFileSystemValues": {
                        "StorageCapacity": 5632
                    },
                    "RequestTime": 1591566856.333,
                    "AdministrativeActionType": "FILE_SYSTEM_UPDATE"
                },
                {
                    "Status": "IN_PROGRESS",
                    "RequestTime": 1591566856.333,
                    "AdministrativeActionType": "STORAGE_OPTIMIZATION",
                    "ProgressPercent": 0
                }
            ],
            "Lifecycle": "AVAILABLE"
        }
    ]
}
----
+
. Note the *AdministrativeActions* attributes of the results.
. It may take 8-9 minutes for the storage capacity scaling action to complete.
. Return to the link:https://console.aws.amazon.com/fsx/[Amazon FSx] console. *_Click_* the link to the *MAZ* file system.
. Refresh the page occassionally to determine if the storage capacity scaling action is complete.
. *_Click_* the *Monitoring* tab and monitor the *Free storage capacity* widget. *_Click_* the refresh image:refresh.png[align="left",width=20] button occassionally to refresh the widgets. When the storage capacity scaling action is complete, a large increase in free storage capacity will be displayed in the widget.
. Wait for the storage capacity scaling event to complete before moving on to the next section.

== Next section

Click the button below to go to the next section.

image::scale-throughput-capacity.png[link=../12-scale-throughput-capacity/, align="left",width=420]




